{
  "version": "2.3.0",
   "summary": {
    "title": "Clothing Rental System Threat Model",
    "owner": "AndreFenol",
    "description": "Threat model for a clothing rental system with a public interface (login, register, homepage) and an admin interface (post & account management).",
    "id": 1
  },
  "detail": {
    "contributors": [
      { "name": "AndreFenol" }
    ],
    "diagrams": [
      {
        "id": 0,
        "name": "Clothing Rental System Architecture",
        "elements": [
          {
            "id": "E1",
            "type": "Actor",
            "name": "Customer",
            "description": "Public user who browses and rents clothes.",
            "x": 100,
            "y": 50,
            "width": 120,
            "height": 60
          },
          {
            "id": "E2",
            "type": "Process",
            "name": "Public Web App",
            "description": "Handles login, registration, and displays clothing.",
            "x": 300,
            "y": 50,
            "width": 160,
            "height": 60
          },
          {
            "id": "E3",
            "type": "DataStore",
            "name": "Database",
            "description": "Stores user data, inventory, orders, etc.",
            "x": 550,
            "y": 50,
            "width": 140,
            "height": 60
          },
          {
            "id": "E4",
            "type": "Actor",
            "name": "Admin",
            "description": "Privileged user managing posts/accounts.",
            "x": 100,
            "y": 200,
            "width": 120,
            "height": 60
          },
          {
            "id": "E5",
            "type": "Process",
            "name": "Admin Dashboard",
            "description": "Admin interface for post/account management.",
            "x": 300,
            "y": 200,
            "width": 160,
            "height": 60
          }
        ],
        "dataFlows": [
          {
            "from": "E1",
            "to": "E2",
            "description": "Customer -> Public Web App"
          },
          {
            "from": "E2",
            "to": "E3",
            "description": "Public Web App -> Database"
          },
          {
            "from": "E4",
            "to": "E5",
            "description": "Admin -> Admin Dashboard"
          },
          {
            "from": "E5",
            "to": "E3",
            "description": "Admin Dashboard -> Database"
          }
        ],
        "trustBoundaries": [
          {
            "id": "TB1",
            "elements": ["E1", "E2"],
            "description": "Public trust boundary: separates untrusted customer traffic."
          },
          {
            "id": "TB2",
            "elements": ["E4", "E5"],
            "description": "Admin trust boundary: isolates privileged operations."
          }
        ],
        "diagramJson": {
          "cells": [
            {
              "id": "actor1",
              "type": "tm.Actor",
              "z": 1,
              "position": { "x": 100, "y": 50 },
              "size": { "width": 120, "height": 60 },
              "labels": [
                {
                  "attrs": {
                    "text": {
                      "text": "Customer (E1)"
                    }
                  }
                }
              ],
              "attrs": {
                "body": {
                  "fill": "#ffffff",
                  "stroke": "#000000"
                }
              }
            },
            {
              "id": "process1",
              "type": "tm.Process",
              "z": 2,
              "position": { "x": 300, "y": 50 },
              "size": { "width": 160, "height": 60 },
              "labels": [
                {
                  "attrs": {
                    "text": {
                      "text": "Public Web App (E2)"
                    }
                  }
                }
              ],
              "attrs": {
                "body": {
                  "fill": "#ffffff",
                  "stroke": "#000000"
                }
              }
            },
            {
              "id": "store1",
              "type": "tm.Store",
              "z": 3,
              "position": { "x": 550, "y": 50 },
              "size": { "width": 140, "height": 60 },
              "labels": [
                {
                  "attrs": {
                    "text": {
                      "text": "Database (E3)"
                    }
                  }
                }
              ],
              "attrs": {
                "body": {
                  "fill": "#ffffff",
                  "stroke": "#000000"
                }
              }
            },
            {
              "id": "actor2",
              "type": "tm.Actor",
              "z": 4,
              "position": { "x": 100, "y": 200 },
              "size": { "width": 120, "height": 60 },
              "labels": [
                {
                  "attrs": {
                    "text": {
                      "text": "Admin (E4)"
                    }
                  }
                }
              ],
              "attrs": {
                "body": {
                  "fill": "#ffffff",
                  "stroke": "#000000"
                }
              }
            },
            {
              "id": "process2",
              "type": "tm.Process",
              "z": 5,
              "position": { "x": 300, "y": 200 },
              "size": { "width": 160, "height": 60 },
              "labels": [
                {
                  "attrs": {
                    "text": {
                      "text": "Admin Dashboard (E5)"
                    }
                  }
                }
              ],
              "attrs": {
                "body": {
                  "fill": "#ffffff",
                  "stroke": "#000000"
                }
              }
            },
            {
              "id": "flow1",
              "type": "tm.Flow",
              "source": { "id": "actor1" },
              "target": { "id": "process1" },
              "z": 6,
              "vertices": [],
              "labels": [
                {
                  "attrs": {
                    "text": {
                      "text": "Customer -> Public Web App"
                    }
                  }
                }
              ],
              "attrs": {
                ".connection": { "stroke": "#000000" }
              }
            },
            {
              "id": "flow2",
              "type": "tm.Flow",
              "source": { "id": "process1" },
              "target": { "id": "store1" },
              "z": 7,
              "vertices": [],
              "labels": [
                {
                  "attrs": {
                    "text": {
                      "text": "Public Web App -> Database"
                    }
                  }
                }
              ],
              "attrs": {
                ".connection": { "stroke": "#000000" }
              }
            },
            {
              "id": "flow3",
              "type": "tm.Flow",
              "source": { "id": "actor2" },
              "target": { "id": "process2" },
              "z": 8,
              "vertices": [],
              "labels": [
                {
                  "attrs": {
                    "text": {
                      "text": "Admin -> Admin Dashboard"
                    }
                  }
                }
              ],
              "attrs": {
                ".connection": { "stroke": "#000000" }
              }
            },
            {
              "id": "flow4",
              "type": "tm.Flow",
              "source": { "id": "process2" },
              "target": { "id": "store1" },
              "z": 9,
              "vertices": [],
              "labels": [
                {
                  "attrs": {
                    "text": {
                      "text": "Admin Dashboard -> Database"
                    }
                  }
                }
              ],
              "attrs": {
                ".connection": { "stroke": "#000000" }
              }
            }
          ]
        }
      }
    ],
    "threats": [
      {
        "id": "T1",
        "target": "E2",
        "category": "Injection",
        "description": "SQL Injection in the Public Web App."
      },
      {
        "id": "T2",
        "target": "E2",
        "category": "Cross-Site Scripting",
        "description": "XSS attacks on the Public Web App."
      },
      {
        "id": "T3",
        "target": "E2",
        "category": "Denial of Service",
        "description": "Possible DoS on the Public Web App."
      },
      {
        "id": "T4",
        "target": "E5",
        "category": "Elevation of Privilege",
        "description": "Broken Access Control on the Admin Dashboard."
      },
      {
        "id": "T5",
        "target": "E3",
        "category": "Data Breach",
        "description": "Database vulnerabilities may lead to unauthorized data access."
      }
    ]
  }
}
